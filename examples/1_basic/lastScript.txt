var wsh = new ActiveXObject("WScript.Shell");

// Add a JS helper that uses the actual COM method
wsh.safeExpandEnv = function(varName) {
    var result = this.ExpandEnvironmentStrings("%" + varName + "%");
    if (result === "%" + varName + "%") {
        return "(undefined)";  // Variable doesn't exist
    }
    return result;
};

alert(wsh)
alert(wsh.safeExpandEnv)

// Now you can call it!
console.log(wsh.safeExpandEnv("PATH"));  // Returns expanded path or "(undefined)"

form.taco('dude')

wsh.Run = function(cmd) {
    console.log("[LOG] " + cmd);
    return this._Run(cmd, 1, true);  // Calls original COM Run
};

wsh.Run("C:\\Windows\\SysWOW64\\notepad.exe")














